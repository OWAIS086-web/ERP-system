{% extends "layout.html" %}

{% block page_title %}Settings{% endblock %}
{% block page_subtitle %}Manage your account settings and preferences{% endblock %}

{% block page_icon %}
<i class="fas fa-cog text-primary"></i>
{% endblock %}

{% block page_actions %}
<button class="btn btn-primary" onclick="saveAllSettings()">
    <i class="fas fa-save"></i> Save All Changes
</button>
{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item active">Settings</li>
{% endblock %}

{% block page_content %}
<div class="row g-4">
    <!-- Settings Navigation -->
    <div class="col-lg-3">
        <div class="glass-card">
            <div class="card-body p-0">
                <div class="settings-nav">
                    <a href="#account" class="settings-nav-item active" data-target="account">
                        <i class="fas fa-user"></i>
                        <span>Account</span>
                    </a>
                    <a href="#security" class="settings-nav-item" data-target="security">
                        <i class="fas fa-shield-alt"></i>
                        <span>Security</span>
                    </a>
                    <a href="#notifications" class="settings-nav-item" data-target="notifications">
                        <i class="fas fa-bell"></i>
                        <span>Notifications</span>
                    </a>
                    <a href="#appearance" class="settings-nav-item" data-target="appearance">
                        <i class="fas fa-palette"></i>
                        <span>Appearance</span>
                    </a>
                    <a href="#privacy" class="settings-nav-item" data-target="privacy">
                        <i class="fas fa-lock"></i>
                        <span>Privacy</span>
                    </a>
                    <a href="#integrations" class="settings-nav-item" data-target="integrations">
                        <i class="fas fa-plug"></i>
                        <span>Integrations</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Settings Content -->
    <div class="col-lg-9">
        <!-- Account Settings -->
        <div class="settings-section active" id="account">
            <div class="glass-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-user me-2"></i>Account Settings
                    </h5>
                </div>
                <div class="card-body">
                    <form class="settings-form">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Username</label>
                                <input type="text" class="form-control" value="{{ current_user.username if current_user.is_authenticated else '' }}" readonly>
                                <div class="form-text">Username cannot be changed</div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Account Status</label>
                                <div class="form-control-plaintext">
                                    <span class="badge bg-success">Active</span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Member Since</label>
                                <div class="form-control-plaintext">
                                    {{ current_user.created_at.strftime('%B %d, %Y') if current_user.is_authenticated else 'N/A' }}
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Last Login</label>
                                <div class="form-control-plaintext">
                                    {{ current_user.last_login.strftime('%B %d, %Y at %I:%M %p') if current_user.is_authenticated and current_user.last_login else 'Never' }}
                                </div>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="row g-3">
                            <div class="col-12">
                                <h6>Account Actions</h6>
                            </div>
                            <div class="col-md-6">
                                <button type="button" class="btn btn-outline-primary w-100" onclick="exportAccountData()">
                                    <i class="fas fa-download me-2"></i>Export Account Data
                                </button>
                            </div>
                            <div class="col-md-6">
                                <button type="button" class="btn btn-outline-danger w-100" onclick="deleteAccount()">
                                    <i class="fas fa-trash me-2"></i>Delete Account
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Security Settings -->
        <div class="settings-section" id="security">
            <div class="glass-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-shield-alt me-2"></i>Security Settings
                    </h5>
                </div>
                <div class="card-body">
                    <form class="settings-form">
                        <div class="security-section">
                            <h6>Password</h6>
                            <p class="text-muted">Manage your password and security settings</p>
                            <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#changePasswordModal">
                                <i class="fas fa-key me-2"></i>Change Password
                            </button>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="security-section">
                            <h6>Two-Factor Authentication</h6>
                            <p class="text-muted">Add an extra layer of security to your account</p>
                            <div class="d-flex align-items-center justify-content-between">
                                <div>
                                    <strong>Status:</strong> 
                                    <span class="badge bg-danger">Disabled</span>
                                </div>
                                <button type="button" class="btn btn-outline-success" onclick="enable2FA()">
                                    <i class="fas fa-mobile-alt me-2"></i>Enable 2FA
                                </button>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="security-section">
                            <h6>Login Sessions</h6>
                            <p class="text-muted">Manage your active login sessions</p>
                            <div class="session-list">
                                <div class="session-item">
                                    <div class="session-info">
                                        <div class="session-device">
                                            <i class="fas fa-desktop me-2"></i>
                                            <strong>Current Session</strong>
                                        </div>
                                        <div class="session-details">
                                            <small class="text-muted">Windows • Chrome • 192.168.1.100</small>
                                        </div>
                                    </div>
                                    <span class="badge bg-success">Active</span>
                                </div>
                                <div class="session-item">
                                    <div class="session-info">
                                        <div class="session-device">
                                            <i class="fas fa-mobile-alt me-2"></i>
                                            Mobile Device
                                        </div>
                                        <div class="session-details">
                                            <small class="text-muted">iOS • Safari • Last seen 2 hours ago</small>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-outline-danger" onclick="revokeSession(this)">
                                        Revoke
                                    </button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-outline-warning mt-3" onclick="revokeAllSessions()">
                                <i class="fas fa-sign-out-alt me-2"></i>Revoke All Other Sessions
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Notification Settings -->
        <div class="settings-section" id="notifications">
            <div class="glass-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-bell me-2"></i>Notification Settings
                    </h5>
                </div>
                <div class="card-body">
                    <form class="settings-form">
                        <div class="notification-group">
                            <h6>Email Notifications</h6>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="emailSystem" checked>
                                <label class="form-check-label" for="emailSystem">
                                    System alerts and important updates
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="emailOrders" checked>
                                <label class="form-check-label" for="emailOrders">
                                    Order and transaction updates
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="emailReports">
                                <label class="form-check-label" for="emailReports">
                                    Weekly and monthly reports
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="emailMarketing">
                                <label class="form-check-label" for="emailMarketing">
                                    Marketing and promotional emails
                                </label>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="notification-group">
                            <h6>Push Notifications</h6>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="pushSystem" checked>
                                <label class="form-check-label" for="pushSystem">
                                    System alerts
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="pushMessages" checked>
                                <label class="form-check-label" for="pushMessages">
                                    New messages and mentions
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="pushReminders" checked>
                                <label class="form-check-label" for="pushReminders">
                                    Task and deadline reminders
                                </label>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="notification-group">
                            <h6>Notification Frequency</h6>
                            <select class="form-select">
                                <option value="immediate">Immediate</option>
                                <option value="hourly">Hourly digest</option>
                                <option value="daily" selected>Daily digest</option>
                                <option value="weekly">Weekly digest</option>
                            </select>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Appearance Settings -->
        <div class="settings-section" id="appearance">
            <div class="glass-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-palette me-2"></i>Appearance Settings
                    </h5>
                </div>
                <div class="card-body">
                    <form class="settings-form">
                        <div class="appearance-group">
                            <h6>Theme Mode</h6>
                            <p class="text-muted mb-3">Choose your preferred theme mode</p>
                            <div class="theme-options">
                                <div class="theme-option" data-theme="light">
                                    <div class="theme-preview light-theme">
                                        <div class="theme-header"></div>
                                        <div class="theme-sidebar"></div>
                                        <div class="theme-content"></div>
                                    </div>
                                    <div class="theme-label">Light</div>
                                    <div class="theme-description">Clean and bright interface</div>
                                </div>
                                <div class="theme-option active" data-theme="dark">
                                    <div class="theme-preview dark-theme">
                                        <div class="theme-header"></div>
                                        <div class="theme-sidebar"></div>
                                        <div class="theme-content"></div>
                                    </div>
                                    <div class="theme-label">Dark</div>
                                    <div class="theme-description">Easy on the eyes</div>
                                </div>
                                <div class="theme-option" data-theme="auto">
                                    <div class="theme-preview auto-theme">
                                        <div class="theme-header"></div>
                                        <div class="theme-sidebar"></div>
                                        <div class="theme-content"></div>
                                    </div>
                                    <div class="theme-label">Auto</div>
                                    <div class="theme-description">Follows system preference</div>
                                </div>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="appearance-group">
                            <h6>Color Scheme</h6>
                            <p class="text-muted mb-3">Select your preferred color palette</p>
                            <div class="color-schemes">
                                <div class="color-scheme active" data-scheme="default">
                                    <div class="color-preview">
                                        <span style="background: #3b82f6;"></span>
                                        <span style="background: #6366f1;"></span>
                                        <span style="background: #8b5cf6;"></span>
                                    </div>
                                    <div class="scheme-label">Default Blue</div>
                                    <div class="scheme-description">Professional blue tones</div>
                                </div>
                                <div class="color-scheme" data-scheme="ocean">
                                    <div class="color-preview">
                                        <span style="background: #0ea5e9;"></span>
                                        <span style="background: #0284c7;"></span>
                                        <span style="background: #0369a1;"></span>
                                    </div>
                                    <div class="scheme-label">Ocean</div>
                                    <div class="scheme-description">Deep ocean blues</div>
                                </div>
                                <div class="color-scheme" data-scheme="forest">
                                    <div class="color-preview">
                                        <span style="background: #059669;"></span>
                                        <span style="background: #047857;"></span>
                                        <span style="background: #065f46;"></span>
                                    </div>
                                    <div class="scheme-label">Forest</div>
                                    <div class="scheme-description">Natural green tones</div>
                                </div>
                                <div class="color-scheme" data-scheme="sunset">
                                    <div class="color-preview">
                                        <span style="background: #f97316;"></span>
                                        <span style="background: #ea580c;"></span>
                                        <span style="background: #dc2626;"></span>
                                    </div>
                                    <div class="scheme-label">Sunset</div>
                                    <div class="scheme-description">Warm orange and red</div>
                                </div>
                                <div class="color-scheme" data-scheme="purple">
                                    <div class="color-preview">
                                        <span style="background: #8b5cf6;"></span>
                                        <span style="background: #7c3aed;"></span>
                                        <span style="background: #6d28d9;"></span>
                                    </div>
                                    <div class="scheme-label">Purple</div>
                                    <div class="scheme-description">Rich purple shades</div>
                                </div>
                                <div class="color-scheme" data-scheme="emerald">
                                    <div class="color-preview">
                                        <span style="background: #10b981;"></span>
                                        <span style="background: #059669;"></span>
                                        <span style="background: #047857;"></span>
                                    </div>
                                    <div class="scheme-label">Emerald</div>
                                    <div class="scheme-description">Vibrant emerald green</div>
                                </div>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="appearance-group">
                            <h6>Display Options</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="compactMode">
                                        <label class="form-check-label" for="compactMode">
                                            <strong>Compact Mode</strong>
                                            <div class="form-text">Reduce spacing for more content</div>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="animations" checked>
                                        <label class="form-check-label" for="animations">
                                            <strong>Enable Animations</strong>
                                            <div class="form-text">Smooth transitions and effects</div>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="sidebarCollapsed">
                                        <label class="form-check-label" for="sidebarCollapsed">
                                            <strong>Collapsed Sidebar</strong>
                                            <div class="form-text">Start with sidebar minimized</div>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="highContrast">
                                        <label class="form-check-label" for="highContrast">
                                            <strong>High Contrast</strong>
                                            <div class="form-text">Improved accessibility</div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="appearance-group">
                            <h6>Font Settings</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="fontSize" class="form-label">Font Size</label>
                                    <select class="form-select" id="fontSize">
                                        <option value="small">Small</option>
                                        <option value="medium" selected>Medium</option>
                                        <option value="large">Large</option>
                                        <option value="extra-large">Extra Large</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="fontFamily" class="form-label">Font Family</label>
                                    <select class="form-select" id="fontFamily">
                                        <option value="inter" selected>Inter (Default)</option>
                                        <option value="roboto">Roboto</option>
                                        <option value="open-sans">Open Sans</option>
                                        <option value="system">System Font</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <button type="button" class="btn btn-outline-secondary" onclick="resetAppearanceSettings()">
                                <i class="fas fa-undo"></i> Reset to Default
                            </button>
                            <button type="button" class="btn btn-primary ms-2" onclick="previewChanges()">
                                <i class="fas fa-eye"></i> Preview Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Privacy Settings -->
        <div class="settings-section" id="privacy">
            <div class="glass-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-lock me-2"></i>Privacy Settings
                    </h5>
                </div>
                <div class="card-body">
                    <form class="settings-form">
                        <div class="privacy-group">
                            <h6>Profile Visibility</h6>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="profileVisibility" id="profilePublic" value="public">
                                <label class="form-check-label" for="profilePublic">
                                    Public - Visible to all users
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="profileVisibility" id="profileTeam" value="team" checked>
                                <label class="form-check-label" for="profileTeam">
                                    Team only - Visible to team members
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="profileVisibility" id="profilePrivate" value="private">
                                <label class="form-check-label" for="profilePrivate">
                                    Private - Only visible to you
                                </label>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="privacy-group">
                            <h6>Activity Tracking</h6>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="trackActivity" checked>
                                <label class="form-check-label" for="trackActivity">
                                    Allow activity tracking for analytics
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="shareUsage">
                                <label class="form-check-label" for="shareUsage">
                                    Share usage data to improve the service
                                </label>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="privacy-group">
                            <h6>Data Retention</h6>
                            <p class="text-muted">Control how long your data is stored</p>
                            <select class="form-select">
                                <option value="1year">1 year</option>
                                <option value="2years" selected>2 years</option>
                                <option value="5years">5 years</option>
                                <option value="forever">Keep forever</option>
                            </select>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Integrations Settings -->
        <div class="settings-section" id="integrations">
            <div class="glass-card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-plug me-2"></i>Integrations
                    </h5>
                </div>
                <div class="card-body">
                    <div class="integrations-list">
                        <div class="integration-item">
                            <div class="integration-info">
                                <div class="integration-icon">
                                    <i class="fab fa-slack"></i>
                                </div>
                                <div class="integration-details">
                                    <h6>Slack</h6>
                                    <p class="text-muted">Get notifications in your Slack workspace</p>
                                </div>
                            </div>
                            <button class="btn btn-outline-primary" onclick="connectIntegration('slack')">
                                Connect
                            </button>
                        </div>
                        
                        <div class="integration-item">
                            <div class="integration-info">
                                <div class="integration-icon">
                                    <i class="fab fa-microsoft"></i>
                                </div>
                                <div class="integration-details">
                                    <h6>Microsoft Teams</h6>
                                    <p class="text-muted">Sync with Microsoft Teams channels</p>
                                </div>
                            </div>
                            <button class="btn btn-outline-primary" onclick="connectIntegration('teams')">
                                Connect
                            </button>
                        </div>
                        
                        <div class="integration-item connected">
                            <div class="integration-info">
                                <div class="integration-icon">
                                    <i class="fab fa-google"></i>
                                </div>
                                <div class="integration-details">
                                    <h6>Google Workspace</h6>
                                    <p class="text-muted">Connected to your Google account</p>
                                </div>
                            </div>
                            <button class="btn btn-outline-danger" onclick="disconnectIntegration('google')">
                                Disconnect
                            </button>
                        </div>
                        
                        <div class="integration-item">
                            <div class="integration-info">
                                <div class="integration-icon">
                                    <i class="fab fa-github"></i>
                                </div>
                                <div class="integration-details">
                                    <h6>GitHub</h6>
                                    <p class="text-muted">Link your GitHub repositories</p>
                                </div>
                            </div>
                            <button class="btn btn-outline-primary" onclick="connectIntegration('github')">
                                Connect
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.settings-nav {
    padding: 0;
}

.settings-nav-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px 20px;
    color: var(--text-secondary);
    text-decoration: none;
    border-bottom: 1px solid var(--glass-border);
    transition: all 0.3s ease;
}

.settings-nav-item:hover {
    background: rgba(255, 255, 255, 0.05);
    color: var(--text-primary);
    text-decoration: none;
}

.settings-nav-item.active {
    background: rgba(59, 130, 246, 0.1);
    color: var(--primary-color);
    border-right: 3px solid var(--primary-color);
}

.settings-nav-item i {
    width: 20px;
    text-align: center;
}

.settings-section {
    display: none;
}

.settings-section.active {
    display: block;
}

.security-section,
.notification-group,
.appearance-group,
.privacy-group {
    margin-bottom: 32px;
}

.security-section:last-child,
.notification-group:last-child,
.appearance-group:last-child,
.privacy-group:last-child {
    margin-bottom: 0;
}

.session-list {
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    overflow: hidden;
}

.session-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px;
    border-bottom: 1px solid var(--glass-border);
}

.session-item:last-child {
    border-bottom: none;
}

.session-device {
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
}

.theme-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 20px;
    margin-bottom: 24px;
}

.theme-option {
    text-align: center;
    cursor: pointer;
    padding: 20px 16px;
    border: 2px solid var(--glass-border);
    border-radius: 16px;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.02);
}

.theme-option:hover {
    border-color: var(--primary-color);
    background: rgba(255, 255, 255, 0.05);
    transform: translateY(-2px);
}

.theme-option.active {
    border-color: var(--primary-color);
    background: rgba(59, 130, 246, 0.1);
    box-shadow: 0 4px 20px rgba(59, 130, 246, 0.2);
}

.theme-preview {
    width: 90px;
    height: 60px;
    border-radius: 8px;
    margin: 0 auto 12px;
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.light-theme {
    background: #f8fafc;
}

.dark-theme {
    background: #1e293b;
}

.auto-theme {
    background: linear-gradient(45deg, #f8fafc 50%, #1e293b 50%);
}

.theme-preview .theme-header {
    height: 12px;
    background: rgba(59, 130, 246, 0.3);
}

.theme-preview .theme-sidebar {
    position: absolute;
    left: 0;
    top: 12px;
    width: 22px;
    height: 48px;
    background: rgba(0, 0, 0, 0.1);
}

.theme-preview .theme-content {
    position: absolute;
    right: 0;
    top: 12px;
    width: 68px;
    height: 48px;
    background: rgba(0, 0, 0, 0.05);
}

.theme-label {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
}

.theme-description {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.3;
}

.color-schemes {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 16px;
}

.color-scheme {
    text-align: center;
    cursor: pointer;
    padding: 16px 12px;
    border: 2px solid var(--glass-border);
    border-radius: 12px;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.02);
}

.color-scheme:hover {
    border-color: var(--primary-color);
    background: rgba(255, 255, 255, 0.05);
    transform: translateY(-2px);
}

.color-scheme.active {
    border-color: var(--primary-color);
    background: rgba(59, 130, 246, 0.1);
    box-shadow: 0 4px 15px rgba(59, 130, 246, 0.2);
}

.color-preview {
    display: flex;
    gap: 4px;
    justify-content: center;
    margin-bottom: 12px;
}

.color-preview span {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.2);
}

.scheme-label {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 4px;
}

.scheme-description {
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.3;
}lor: var(--primary-color);
}

.theme-option.active {
    border-color: var(--primary-color);
    background: rgba(59, 130, 246, 0.1);
}

.theme-preview {
    width: 80px;
    height: 60px;
    border-radius: 8px;
    margin: 0 auto 8px;
    position: relative;
    overflow: hidden;
}

.light-theme {
    background: #f8fafc;
}

.dark-theme {
    background: #1e293b;
}

.auto-theme {
    background: linear-gradient(45deg, #f8fafc 50%, #1e293b 50%);
}

.theme-preview .theme-header {
    height: 12px;
    background: rgba(59, 130, 246, 0.3);
}

.theme-preview .theme-sidebar {
    position: absolute;
    left: 0;
    top: 12px;
    width: 20px;
    height: 48px;
    background: rgba(0, 0, 0, 0.1);
}

.theme-preview .theme-content {
    position: absolute;
    right: 0;
    top: 12px;
    width: 60px;
    height: 48px;
    background: rgba(0, 0, 0, 0.05);
}

.theme-label {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-primary);
}

.color-schemes {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 16px;
}

.color-scheme {
    text-align: center;
    cursor: pointer;
    padding: 12px;
    border: 2px solid var(--glass-border);
    border-radius: 12px;
    transition: all 0.3s ease;
}

.color-scheme:hover {
    border-color: var(--primary-color);
}

.color-scheme.active {
    border-color: var(--primary-color);
    background: rgba(59, 130, 246, 0.1);
}

.color-preview {
    display: flex;
    gap: 4px;
    justify-content: center;
    margin-bottom: 8px;
}

.color-preview span {
    width: 16px;
    height: 16px;
    border-radius: 50%;
}

.scheme-label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-primary);
}

.integrations-list {
    display: grid;
    gap: 16px;
}

.integration-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 20px;
    border: 1px solid var(--glass-border);
    border-radius: 12px;
    transition: all 0.3s ease;
}

.integration-item:hover {
    background: rgba(255, 255, 255, 0.05);
}

.integration-item.connected {
    border-color: var(--success-color);
    background: rgba(16, 185, 129, 0.05);
}

.integration-info {
    display: flex;
    align-items: center;
    gap: 16px;
}

.integration-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: var(--primary-color);
}

.integration-details h6 {
    margin: 0 0 4px 0;
    color: var(--text-primary);
}

.integration-details p {
    margin: 0;
    font-size: 14px;
}

/* Responsive */
@media (max-width: 768px) {
    .theme-options {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .color-schemes {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .integration-item {
        flex-direction: column;
        text-align: center;
        gap: 16px;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Settings navigation
    $('.settings-nav-item').click(function(e) {
        e.preventDefault();
        
        const target = $(this).data('target');
        
        // Update navigation
        $('.settings-nav-item').removeClass('active');
        $(this).addClass('active');
        
        // Update content
        $('.settings-section').removeClass('active');
        $('#' + target).addClass('active');
    });
    
    // Theme selection
    $('.theme-option').click(function() {
        $('.theme-option').removeClass('active');
        $(this).addClass('active');
        
        const theme = $(this).data('theme');
        applyTheme(theme);
    });
    
    // Color scheme selection
    $('.color-scheme').click(function() {
        $('.color-scheme').removeClass('active');
        $(this).addClass('active');
        
        const scheme = $(this).data('scheme');
        applyColorScheme(scheme);
    });
    
    // Display options
    $('#compactMode').change(function() {
        applyDisplayOption('compactMode', this.checked);
    });
    
    $('#animations').change(function() {
        applyDisplayOption('animations', this.checked);
    });
    
    $('#sidebarCollapsed').change(function() {
        applyDisplayOption('sidebarCollapsed', this.checked);
    });
    
    $('#highContrast').change(function() {
        applyDisplayOption('highContrast', this.checked);
    });
    
    // Font settings
    $('#fontSize').change(function() {
        applyFontSettings(this.value, null);
    });
    
    $('#fontFamily').change(function() {
        applyFontSettings(null, this.value);
    });
    
    // Load saved settings
    loadSavedSettings();
});

function applyTheme(theme) {
    if (window.themeManager) {
        window.themeManager.setTheme(theme);
    } else {
        // Fallback if theme manager not available
        if (theme === 'auto') {
            const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            document.documentElement.setAttribute('data-bs-theme', systemTheme);
            document.documentElement.setAttribute('data-theme', systemTheme);
            localStorage.setItem('theme', 'auto');
            localStorage.setItem('actualTheme', systemTheme);
        } else {
            document.documentElement.setAttribute('data-bs-theme', theme);
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            localStorage.setItem('actualTheme', theme);
        }
    }
    
    window.notificationManager?.showToast(`Theme changed to ${theme}`, 'success');
}

function applyColorScheme(scheme) {
    if (window.themeManager) {
        window.themeManager.setColorScheme(scheme);
    } else {
        // Fallback implementation
        document.documentElement.classList.remove('scheme-default', 'scheme-ocean', 'scheme-forest', 'scheme-sunset', 'scheme-purple', 'scheme-emerald');
        document.documentElement.classList.add(`scheme-${scheme}`);
        localStorage.setItem('colorScheme', scheme);
        
        const colorSchemes = {
            default: { primary: '#3b82f6', secondary: '#6366f1', accent: '#8b5cf6' },
            ocean: { primary: '#0ea5e9', secondary: '#0284c7', accent: '#0369a1' },
            forest: { primary: '#059669', secondary: '#047857', accent: '#065f46' },
            sunset: { primary: '#f97316', secondary: '#ea580c', accent: '#dc2626' },
            purple: { primary: '#8b5cf6', secondary: '#7c3aed', accent: '#6d28d9' },
            emerald: { primary: '#10b981', secondary: '#059669', accent: '#047857' }
        };
        
        if (colorSchemes[scheme]) {
            const colors = colorSchemes[scheme];
            const root = document.documentElement;
            root.style.setProperty('--primary-color', colors.primary);
            root.style.setProperty('--secondary-color', colors.secondary);
            root.style.setProperty('--accent-color', colors.accent);
        }
    }
    
    window.notificationManager?.showToast(`Color scheme changed to ${scheme}`, 'success');
}

function applyDisplayOption(option, value) {
    if (window.themeManager) {
        window.themeManager.setDisplayOption(option, value);
    } else {
        // Fallback implementation
        switch (option) {
            case 'compactMode':
                document.body.classList.toggle('compact-mode', value);
                localStorage.setItem('compactMode', value);
                break;
            case 'animations':
                document.body.classList.toggle('no-animations', !value);
                localStorage.setItem('animations', value);
                break;
            case 'highContrast':
                document.body.classList.toggle('high-contrast', value);
                localStorage.setItem('highContrast', value);
                break;
            case 'sidebarCollapsed':
                localStorage.setItem('sidebarCollapsed', value);
                if (window.sidebarManager) {
                    window.sidebarManager.isCollapsed = value;
                    window.sidebarManager.updateSidebarState();
                }
                break;
        }
    }
}

function applyFontSettings(fontSize, fontFamily) {
    if (window.themeManager) {
        window.themeManager.setFontSettings(fontSize, fontFamily);
    } else {
        // Fallback implementation
        if (fontSize) {
            document.documentElement.setAttribute('data-font-size', fontSize);
            localStorage.setItem('fontSize', fontSize);
        }
        if (fontFamily) {
            document.documentElement.setAttribute('data-font-family', fontFamily);
            localStorage.setItem('fontFamily', fontFamily);
        }
    }
}

function loadSavedSettings() {
    // Load theme
    const savedTheme = localStorage.getItem('theme') || 'light';
    $(`.theme-option[data-theme="${savedTheme}"]`).addClass('active');
    
    // Load color scheme
    const savedScheme = localStorage.getItem('colorScheme') || 'default';
    $(`.color-scheme[data-scheme="${savedScheme}"]`).addClass('active');
    applyColorScheme(savedScheme);
    
    // Load display options
    const compactMode = localStorage.getItem('compactMode') === 'true';
    $('#compactMode').prop('checked', compactMode);
    document.body.classList.toggle('compact-mode', compactMode);
    
    const animations = localStorage.getItem('animations') !== 'false';
    $('#animations').prop('checked', animations);
    document.body.classList.toggle('no-animations', !animations);
    
    const sidebarCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
    $('#sidebarCollapsed').prop('checked', sidebarCollapsed);
    
    const highContrast = localStorage.getItem('highContrast') === 'true';
    $('#highContrast').prop('checked', highContrast);
    document.body.classList.toggle('high-contrast', highContrast);
    
    // Load font settings
    const fontSize = localStorage.getItem('fontSize') || 'medium';
    $('#fontSize').val(fontSize);
    document.documentElement.setAttribute('data-font-size', fontSize);
    
    const fontFamily = localStorage.getItem('fontFamily') || 'inter';
    $('#fontFamily').val(fontFamily);
    document.documentElement.setAttribute('data-font-family', fontFamily);
}

function saveAllSettings() {
    const btn = event.target;
    const originalText = btn.innerHTML;
    
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
    btn.disabled = true;
    
    // Simulate save
    setTimeout(() => {
        btn.html(originalText);
        btn.disabled = false;
        window.notificationManager?.showToast('All settings saved successfully', 'success');
    }, 1500);
}

function resetAppearanceSettings() {
    if (confirm('Are you sure you want to reset all appearance settings to default?')) {
        // Reset theme
        $('.theme-option').removeClass('active');
        $('.theme-option[data-theme="light"]').addClass('active');
        applyTheme('light');
        
        // Reset color scheme
        $('.color-scheme').removeClass('active');
        $('.color-scheme[data-scheme="default"]').addClass('active');
        applyColorScheme('default');
        
        // Reset display options
        $('#compactMode').prop('checked', false);
        $('#animations').prop('checked', true);
        $('#sidebarCollapsed').prop('checked', false);
        $('#highContrast').prop('checked', false);
        
        // Reset font settings
        $('#fontSize').val('medium');
        $('#fontFamily').val('inter');
        
        // Apply changes
        document.body.classList.remove('compact-mode', 'no-animations', 'high-contrast');
        document.documentElement.setAttribute('data-font-size', 'medium');
        document.documentElement.setAttribute('data-font-family', 'inter');
        
        // Clear localStorage
        localStorage.removeItem('theme');
        localStorage.removeItem('colorScheme');
        localStorage.removeItem('compactMode');
        localStorage.removeItem('animations');
        localStorage.removeItem('sidebarCollapsed');
        localStorage.removeItem('highContrast');
        localStorage.removeItem('fontSize');
        localStorage.removeItem('fontFamily');
        
        window.notificationManager?.showToast('Appearance settings reset to default', 'success');
    }
}

function previewChanges() {
    window.notificationManager?.showToast('Preview mode activated - changes are live!', 'info');
}

function enable2FA() {
    window.notificationManager?.showToast('2FA setup will be available soon', 'info');
}

function revokeSession(btn) {
    if (confirm('Are you sure you want to revoke this session?')) {
        $(btn).closest('.session-item').fadeOut();
        window.notificationManager?.showToast('Session revoked successfully', 'success');
    }
}

function revokeAllSessions() {
    if (confirm('Are you sure you want to revoke all other sessions? You will need to log in again on other devices.')) {
        $('.session-item').not(':first').fadeOut();
        window.notificationManager?.showToast('All other sessions revoked', 'success');
    }
}

function exportAccountData() {
    window.notificationManager?.showToast('Account data export will be sent to your email', 'info');
}

function deleteAccount() {
    if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
        window.notificationManager?.showToast('Account deletion request submitted', 'warning');
    }
}

function connectIntegration(service) {
    window.notificationManager?.showToast(`${service.charAt(0).toUpperCase() + service.slice(1)} integration will be available soon`, 'info');
}

function disconnectIntegration(service) {
    if (confirm(`Are you sure you want to disconnect ${service}?`)) {
        window.notificationManager?.showToast(`${service.charAt(0).toUpperCase() + service.slice(1)} disconnected successfully`, 'success');
    }
}
</script>
{% endblock %}